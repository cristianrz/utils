#!/bin/sh
set -eu

HERE="$(
	cd "$(dirname "$0")"
	pwd
)"

service_dir="$HERE/rc.d"

mkdir -p "$service_dir"

. "$HERE/rc.conf"

find "$service_dir" -type f | sort | while read -r service; do
	service_short="$(basename "$service")"

	case "$(eval 'echo $'"$service_short")" in
	YES) "$service" start ;;
	esac
done

if [ -f "$HERE/rc.local" ]; then
	"$HERE/rc.local"
fi

exit 0
